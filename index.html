<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Electronic Pen Documentation</title>
    
    <!-- Load dependencies -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/9.3.0/mermaid.min.js"></script>
    
    <style>
        .diagram-container {
            min-height: 500px;
            width: 100%;
            position: relative;
        }

        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .component-card {
            transform: translateY(50px);
            opacity: 0;
            transition: all 0.5s ease-out;
        }

        .component-card.visible {
            transform: translateY(0);
            opacity: 1;
        }

        #webgl-container {
            width: 100%;
            height: 400px;
            position: relative;
            overflow: hidden;
            border-radius: 8px;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e7eb 100%);
        }

        .section-fade-in {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }

        .section-fade-in.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .mermaid {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="bg-gray-100">
      <div class="container mx-auto px-4 py-8">
        <h1 class="text-4xl font-bold mb-8 text-center">Electronic Pen Structure Analysis</h1>

        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <h2 class="text-2xl font-bold mb-4">Overview</h2>
            <p class="mb-4">The US10216295B2 patent describes an innovative electronic pen that combines mechanical pencil functionality with digital input capabilities. This pen can detect writing pressure and transmit data while leaving physical marks on paper.</p>
        </div>

        <!-- Core Components Structure -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <h2 class="text-2xl font-bold mb-4">Core Components Structure</h2>
            <div class="mermaid">
                flowchart TD
                    A[Electronic Pen] --> B[Writing Device]
                    A --> C[Pressure System]
                    A --> D[Electronics]
                    B --> B1[First Portion]
                    B --> B2[Second Portion]
                    C --> C1[Pen Pressure Transmitter]
                    C --> C2[Pen Pressure Detector]
                    D --> D1[Core Section]
                    D --> D2[Circuit Board]
                    D --> D3[Transmission Circuit]
            </div>
        </div>

        <!-- Writing Device Details -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <h2 class="text-2xl font-bold mb-4">Writing Device Components</h2>
            <div class="mermaid">
                flowchart TD
                    WD[Writing Device] --> FP[First Portion]
                    WD --> SP[Second Portion]
                    FP --> TP[Tapered Pen Tip]
                    FP --> LDM[Lead Delivery Mechanism]
                    LDM --> CS[Chuck Section]
                    LDM --> GS[Grasping Section]
                    LDM --> CSpring[Coil Spring]
                    SP --> LIP[Lead Insertion Port]
                    SP --> TB[Tubular Body]
            </div>
        </div>

        <!-- Pressure Detection System -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <h2 class="text-2xl font-bold mb-4">Pressure Detection System</h2>
            <div class="mermaid">
                flowchart TD
                    PDS[Pressure Detection System] --> PPT[Pen Pressure Transmitter]
                    PDS --> PPD[Pen Pressure Detector]
                    PPT --> TP[Tubular Portion]
                    PPT --> EP[Extension Portion]
                    PPT --> PP[Pressing Portion]
                    PPD --> HS[Holding Section]
                    PPD --> CR[Conductive Rubber]
                    PPD --> CP[Connection Portion]
            </div>
        </div>

        <!-- Detailed Explanations -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <h2 class="text-2xl font-bold mb-4">Technical Details</h2>
            
            <h3 class="text-xl font-bold mb-2">Writing Device</h3>
            <p class="mb-4">The writing device consists of two main portions:</p>
            <ul class="list-disc ml-6 mb-4">
                <li>First Portion: Contains the pen tip and lead delivery mechanism</li>
                <li>Second Portion: Houses the lead storage and insertion system</li>
            </ul>

            <h3 class="text-xl font-bold mb-2">Pressure System</h3>
            <p class="mb-4">The innovative pressure detection system includes:</p>
            <ul class="list-disc ml-6 mb-4">
                <li>Pen Pressure Transmitter: Transfers writing pressure through a mechanical linkage</li>
                <li>Pressure Detector: Converts mechanical pressure into electronic signals</li>
            </ul>

            <h3 class="text-xl font-bold mb-2">Electronic Components</h3>
            <p class="mb-4">The electronic system consists of:</p>
            <ul class="list-disc ml-6 mb-4">
                <li>Core Section: Contains the coil for electromagnetic resonance</li>
                <li>Circuit Board: Processes pressure and position data</li>
                <li>Transmission Circuit: Communicates with the position detecting device</li>
            </ul>
        </div>

        <!-- Key Innovations -->
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-2xl font-bold mb-4">Key Innovations</h2>
            <ul class="list-disc ml-6">
                <li class="mb-2">Off-axis pressure detection system that doesn't interfere with lead movement</li>
                <li class="mb-2">Integrated mechanical pencil functionality with digital input capabilities</li>
                <li class="mb-2">Dual-purpose design allowing both physical writing and digital data capture</li>
                <li class="mb-2">Compatible with both EMR and AES position detecting systems</li>
            </ul>
        </div>
    </div>
    <div class="container mx-auto px-4 py-8">
        <!-- Main Header -->
        <header class="text-center mb-12">
            <h1 class="text-4xl font-bold mb-4">Electronic Pen Structure</h1>
            <p class="text-xl text-gray-600">Interactive Technical Documentation</p>
        </header>

        <!-- 3D Model Section -->
        <section class="mb-12 section-fade-in">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold mb-4">3D Model View</h2>
                <div id="webgl-container">
                    <div class="loading">Loading 3D Model...</div>
                </div>
                <div class="mt-4 text-gray-600 text-sm">
                    Click and drag to rotate. Scroll to zoom.
                </div>
            </div>
        </section>

        <!-- Component Breakdown -->
        <section class="mb-12">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Writing Device -->
                <div class="component-card bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-xl font-bold mb-4">Writing Device</h3>
                    <ul class="space-y-2">
                        <li>First Portion (10A)</li>
                        <li>Second Portion (10B)</li>
                        <li>Lead Delivery Mechanism</li>
                    </ul>
                </div>

                <!-- Pressure System -->
                <div class="component-card bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-xl font-bold mb-4">Pressure System</h3>
                    <ul class="space-y-2">
                        <li>Pressure Transmitter (14)</li>
                        <li>Pressure Detector (15)</li>
                        <li>Signal Processing</li>
                    </ul>
                </div>

                <!-- Electronics -->
                <div class="component-card bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-xl font-bold mb-4">Electronics</h3>
                    <ul class="space-y-2">
                        <li>Circuit Board (16)</li>
                        <li>Core Section (11)</li>
                        <li>Resonance Circuit</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Structure Diagram -->
        <section class="mb-12 section-fade-in">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold mb-4">Component Structure</h2>
                <div class="mermaid">
                    graph TD
                        A[Electronic Pen] --> B[Writing Device]
                        A --> C[Pressure System]
                        A --> D[Electronics]
                        
                        B --> B1[First Portion]
                        B --> B2[Second Portion]
                        B1 --> B1a[Pen Tip]
                        B1 --> B1b[Lead Mechanism]
                        
                        C --> C1[Transmitter]
                        C --> C2[Detector]
                        
                        D --> D1[Circuit Board]
                        D --> D2[Core Section]
                        
                        style A fill:#f9f,stroke:#333,stroke-width:2px
                        style B fill:#bbf,stroke:#333
                        style C fill:#bfb,stroke:#333
                        style D fill:#fbb,stroke:#333
                </div>
            </div>
        </section>
    </div>

    <script type="module">
        import * as THREE from 'https://cdn.skypack.dev/three@0.158.0';
        import { OrbitControls } from 'https://cdn.skypack.dev/three@0.158.0/examples/jsm/controls/OrbitControls.js';

        // Initialize all systems after DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize Mermaid
            mermaid.initialize({
                startOnLoad: true,
                theme: 'default',
                securityLevel: 'loose',
                flowchart: {
                    curve: 'basis'
                }
            });

            // Initialize GSAP ScrollTrigger
            gsap.registerPlugin(ScrollTrigger);

            // Setup scroll animations
            setupScrollAnimations();

            // Initialize 3D Model
            setup3DScene();
        });

        function setupScrollAnimations() {
            // Animate sections on scroll
            document.querySelectorAll('.section-fade-in').forEach(section => {
                ScrollTrigger.create({
                    trigger: section,
                    start: 'top 80%',
                    onEnter: () => section.classList.add('visible'),
                    once: true
                });
            });

            // Animate component cards
            document.querySelectorAll('.component-card').forEach((card, index) => {
                gsap.to(card, {
                    scrollTrigger: {
                        trigger: card,
                        start: 'top 80%'
                    },
                    opacity: 1,
                    y: 0,
                    duration: 0.6,
                    delay: index * 0.2
                });
            });
        }

        function setup3DScene() {
            const container = document.getElementById('webgl-container');
            
            // Create scene
            const scene = new THREE.Scene();
            scene.background = new THREE.Color(0xf5f7fa);

            // Setup camera
            const camera = new THREE.PerspectiveCamera(
                75,
                container.clientWidth / container.clientHeight,
                0.1,
                1000
            );
            camera.position.z = 5;

            // Setup renderer
            const renderer = new THREE.WebGLRenderer({ 
                antialias: true,
                powerPreference: "high-performance" 
            });
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.setSize(container.clientWidth, container.clientHeight);
            container.appendChild(renderer.domElement);

            // Add OrbitControls
            const controls = new OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;

            // Create pen model
            const penGeometry = new THREE.CylinderGeometry(0.2, 0.2, 2, 32);
            const penMaterial = new THREE.MeshPhysicalMaterial({
                color: 0x156289,
                metalness: 0.5,
                roughness: 0.3,
                clearcoat: 0.3,
                clearcoatRoughness: 0.25
            });
            const pen = new THREE.Mesh(penGeometry, penMaterial);
            scene.add(pen);

            // Add lighting
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
            scene.add(ambientLight);

            const pointLight1 = new THREE.PointLight(0xffffff, 1);
            pointLight1.position.set(5, 5, 5);
            scene.add(pointLight1);

            const pointLight2 = new THREE.PointLight(0xffffff, 0.5);
            pointLight2.position.set(-5, -5, -5);
            scene.add(pointLight2);

            // Handle window resize
            window.addEventListener('resize', () => {
                const newWidth = container.clientWidth;
                const newHeight = container.clientHeight;

                camera.aspect = newWidth / newHeight;
                camera.updateProjectionMatrix();

                renderer.setSize(newWidth, newHeight);
            }, false);

            // Animation loop
            function animate() {
                requestAnimationFrame(animate);
                controls.update();
                renderer.render(scene, camera);
            }

            // Remove loading message and start animation
            container.querySelector('.loading').style.display = 'none';
            animate();

            // Cleanup function
            return () => {
                window.removeEventListener('resize', onWindowResize);
                renderer.dispose();
                geometry.dispose();
                material.dispose();
            };
        }
    </script>
</body>
</html>
